commands:
  01_download_model:
    command: |
      curl -L -o /tmp/model.zip https://virtualscale-cdn.s3.us-east-2.amazonaws.com/vosk/models/med/vosk-model-en-us-daanzu-20200905.zip
      mkdir -p /var/app/current/src/models/med
      unzip -q /tmp/model.zip -d /tmp
      mv /tmp/vosk-model-en-us-daanzu-20200905 /var/app/current/src/models/med/
      rm /tmp/model.zip
    cwd: /tmp
    ignoreErrors: false

files:
  "/tmp/check_model.sh":
    mode: "000755"
    owner: root
    group: root
    content: |
      #!/bin/bash
      if [ -d "/var/app/current/src/models/med/vosk-model-en-us-daanzu-20200905" ]; then
        echo "Model directory exists"
        exit 0
      else
        echo "Model directory does not exist"
        exit 1
      fi

commands:
  02_verify_model:
    command: /tmp/check_model.sh
    ignoreErrors: false